<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>PulseMind™ Demo – Garmin Preview</title>
  <style>
    :root{
      --bg:#0b0c0d;
      --card:#121417;
      --ink:#f5f7fa;
      --muted:#98a2ad;
      --accent:#00a3ff;
      --border:#1f2328;
      --chip:#0e1b22;
    }
    *{box-sizing:border-box}
    body{
      margin:0;background:var(--bg);color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      line-height:1.45;
    }
    .wrap{max-width:900px;margin:32px auto;padding:0 16px}
    header{display:flex;align-items:center;gap:14px;margin-bottom:10px}
    header img{height:28px}
    h1{font-size:28px;margin:6px 0 2px}
    .badge{display:inline-block;font-size:12px;padding:3px 8px;border-radius:999px;
      border:1px solid var(--border);background:var(--chip);color:var(--muted);margin-left:8px}
    p.small{color:var(--muted);margin:6px 0 20px}

    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;margin:18px 0}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .row>*{flex:1 1 260px}
    textarea{width:100%;min-height:240px;background:#0d0f12;border:1px solid var(--border);border-radius:10px;color:var(--ink);padding:10px;font-family:ui-monospace,Menlo,Consolas}
    button{padding:10px 14px;border-radius:10px;border:1px solid var(--border);background:#101418;color:var(--ink);cursor:pointer}
    button.primary{background:var(--accent);border-color:#0597ea;color:#001018;font-weight:700}
    button:active{transform:translateY(1px)}
    label.file{display:inline-block;padding:10px 14px;border-radius:10px;border:1px dashed var(--border);cursor:pointer;background:#0d1013}
    input[type=file]{display:none}
    .kpis{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;margin-top:12px}
    .kpi{padding:14px;border-radius:10px;border:1px solid var(--border);background:#0e1014}
    .kpi .label{color:var(--muted);font-size:12px;margin-bottom:4px}
    .kpi .value{font-size:28px;font-weight:800}
    h2{font-size:18px;margin:0 0 8px}
    ul.small{color:var(--muted);padding-left:18px;margin:6px 0}
    pre{white-space:pre-wrap;background:#0d0f12;border:1px solid var(--border);border-radius:10px;color:#cdd6e1;padding:12px;overflow:auto}
    footer{color:var(--muted);text-align:center;margin:20px 0}
    a{color:var(--accent);text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>

    </header>
<img src="https://upload.wikimedia.org/wikipedia/commons/a/a6/Garmin_logo_2006.svg" 
     alt="Garmin Logo" 
     style="height:60px; margin-bottom:12px;">
    <h1>PulseMind™ Demo <span class="badge">Garmin Preview</span></h1>
    <p class="small">Concept demo with simplified logic. No proprietary model weights or production logic included.</p>

    <div class="card">
      <div class="row">
        <div>
          <h2>1) Load data</h2>
          <p class="small">Use the sample below or upload your own JSON with fields: <code>date, hr_rest, rmssd, sleep_hours, load</code>.</p>
          <div class="row">
            <button id="loadSample">Load <code>sample_week.json</code></button>
            <label class="file">
              <input id="file" type="file" accept=".json,application/json">
              Upload JSON…
            </label>
            <button id="clear">Clear</button>
          </div>
        </div>
      </div>
      <textarea id="json" placeholder='[{"date":"2025-08-25","hr_rest":52,"rmssd":58,"sleep_hours":7.2,"load":320}, …]'></textarea>
    </div>

    <div class="card">
      <h2>2) Evaluate</h2>
      <p class="small">Runs a simplified readiness & overload mock.</p>
      <div class="row">
        <button id="eval" class="primary">Evaluate</button>
      </div>
      <div class="kpis">
        <div class="kpi">
          <div class="label">Readiness Score</div>
          <div id="ready" class="value">—</div>
        </div>
        <div class="kpi">
          <div class="label">Overload Risk</div>
          <div id="risk" class="value">—</div>
        </div>
      </div>

      <h2 style="margin-top:16px;">Notes</h2>
      <ul class="small">
        <li>Readiness: 0–100 (higher = better). Mocked from normalized HRV, sleep, and recent load.</li>
        <li>Risk: “Low / Moderate / High” based on acute:chronic load and HRV drift.</li>
      </ul>
    </div>

    <div class="card">
      <h2>Debug Output</h2>
      <pre id="log">Ready.</pre>
    </div>

    <footer>© PulseMind™ Demo • Private Garmin preview • For evaluation only.</footer>
  </div>

  <script>
    async function fetchSample(){
      try{
        const res = await fetch('data/sample_week.json');
        const txt = await res.text();
        document.getElementById('json').value = txt;
      }catch(err){
        document.getElementById('json').value = '[/* sample_week.json not found */]';
      }
    }
    function setKPIs(rdy, risk){
      document.getElementById('ready').textContent = rdy;
      document.getElementById('risk').textContent  = risk;
    }
    function log(msg){document.getElementById('log').textContent=msg;}

    function evaluate(data){
      const n = data.length;
      const avg = arr => arr.reduce((a,b)=>a+b,0) / (arr.length||1);
      const hrvs=data.map(d=>+d.rmssd), sleeps=data.map(d=>+d.sleep_hours), loads=data.map(d=>+d.load);
      const hrvAvg=avg(hrvs), sleepAvg=avg(sleeps), loadSum=loads.reduce((a,b)=>a+b,0);
      const norm=(x,min,max)=>Math.max(0,Math.min(1,(x-min)/(max-min)));
      const readiness=Math.round(100*(0.45*norm(hrvAvg,30,100)+0.35*norm(sleepAvg,5,9)+0.20*(1-norm(loadSum/n,150,600))));
      const k=Math.min(7,n),recent=loads.slice(-k),acute=avg(recent),chronic=avg(loads),ratio=chronic>0?acute/chronic:0;
      const hrvDrift=(hrvs[hrvs.length-1]??hrvAvg)-hrvAvg;
      let risk="Low"; if(ratio>1.3||hrvDrift<-5)risk="Moderate"; if(ratio>1.6||hrvDrift<-10)risk="High";
      return {readiness,risk,details:{hrvAvg,sleepAvg,loadAvg:avg(loads),ratio,hrvDrift}};
    }

    document.getElementById('loadSample').onclick=fetchSample;
    document.getElementById('clear').onclick=()=>{document.getElementById('json').value='';setKPIs('—','—');log('Cleared.')};
    document.getElementById('file').onchange=e=>{const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=()=>document.getElementById('json').value=r.result;r.readAsText(f)};
    document.getElementById('eval').onclick=()=>{try{const d=JSON.parse(document.getElementById('json').value);const o=evaluate(d);setKPIs(o.readiness,o.risk);log(JSON.stringify(o,null,2))}catch(err){setKPIs('—','—');log('Invalid JSON: '+err.message)}};
  </script>
</body>
</html>
